# Decision Log

Bu dosya, proje geliştirme sürecinde alınan tüm önemli kararları kronolojik sırayla dokümante eder.
Her karar için: tarih, bağlam, alternatifler, seçim ve gerekçe kaydedilir.

Format:
```
## [DECISION-XXX] Başlık
**Tarih:** YYYY-MM-DD
**Durum:** Proposed | Accepted | Deprecated | Superseded
**Bağlam:** Kararın alınma nedeni
**Alternatifler:**
1. Seçenek A - artıları/eksileri
2. Seçenek B - artıları/eksileri
**Karar:** Seçilen yol
**Gerekçe:** Neden bu seçildi
**Sonuçlar:** Bu kararın etkileri
**Referanslar:** İlgili makaleler, belgeler
```

---

## [DECISION-001] Proje Odağı: RWS-Merkezli Tasarım
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** V2.2 projesi genel amaçlı QCA + RWS platformuydu. Yeni projede odak ne olmalı?
**Alternatifler:**
1. Genel amaçlı QCA platformu (V2.2 gibi)
2. RWS-odaklı özelleşmiş platform
3. Sadece segmentasyon aracı
**Karar:** RWS-odaklı platform
**Gerekçe:**
- RWS için açık kaynak araç yok
- Akademik yayın potansiyeli yüksek
- Daha net kapsam = daha iyi kod kalitesi
- QCA, RWS'nin ön koşulu olarak dahil edilecek
**Sonuçlar:**
- UI, RWS workflow'una göre tasarlanacak
- QCA, RWS hesaplamasına hizmet edecek şekilde entegre
- Export formatları RWS verilerine öncelik verecek
**Referanslar:**
- Hong et al., EuroIntervention 2023 (RWS metodolojisi)

---

## [DECISION-002] Teknoloji Stack'i
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Hangi teknolojiler kullanılmalı?
**Alternatifler:**
1. Electron + Python backend
2. Tauri + Python backend (V2.2 yaklaşımı)
3. Pure Python (PyQt/PySide)
4. Web-only (React + FastAPI)
**Karar:** Tauri 2.x + React 18 + Python FastAPI backend
**Gerekçe:**
- Tauri: ~10MB bundle vs Electron ~150MB
- Tauri 2.x: Stabil, production-ready
- React: Zengin ekosistem, component reusability
- Python backend: ML/CV kütüphaneleri (PyTorch, OpenCV, pydicom)
- V2.2'de kanıtlanmış mimari
**Sonuçlar:**
- Cross-platform desktop app (Windows, macOS, Linux)
- Performant native UI
- Güçlü ML/CV backend
**Referanslar:**
- Tauri 2.0 release notes
- V2.2 performance benchmarks

---

## [DECISION-003] State Management: Zustand
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Frontend state management nasıl yapılmalı?
**Alternatifler:**
1. Redux Toolkit
2. Zustand
3. Jotai
4. MobX
5. React Context + useReducer
**Karar:** Zustand with Map-based per-frame storage
**Gerekçe:**
- Minimal boilerplate
- TypeScript-first design
- V2.2'de başarıyla test edildi
- Map<number, T> pattern frame-indexed data için ideal
- getState() ile async context'te güvenli erişim
**Sonuçlar:**
- ~8-10 store (V2.2'deki 11'den sadeleştirilmiş)
- Her store tek sorumluluk
- persist middleware ile session recovery
**Referanslar:**
- Zustand documentation
- V2.2 store implementations

---

## [DECISION-004] Segmentasyon Stratejisi
**Tarih:** 2024-11-24
**Durum:** Superseded by DECISION-008
**Bağlam:** Vessel segmentasyonu için hangi model/yaklaşım?
**Alternatifler:**
1. AngioPy (InceptionResNetV2 + U-Net)
2. nnU-Net v2
3. Segment Anything Model (SAM)
4. Custom trained model
5. Hybrid (AngioPy + nnU-Net)
**Karar:** ~~AngioPy as primary, nnU-Net as optional enhancement~~
**Not:** Bu karar DECISION-008 ile güncellendi. Custom nnU-Net birincil model olacak.
**Referanslar:**
- AngioPy GitLab: https://gitlab.com/epfl-center-for-imaging/angiopy
- nnU-Net paper: Isensee et al., Nature Methods 2021

---

## [DECISION-005] Tracking Algoritması
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Vessel ROI'yi frame'ler arası nasıl takip edeceğiz?
**Alternatifler:**
1. Pure CSRT tracker
2. Pure Optical Flow (Lucas-Kanade)
3. Deep learning tracker (RAFT, FlowNet)
4. Template matching only
5. Hybrid CSRT + Template + Optical Flow
**Karar:** Hybrid approach (CSRT primary + Template Matching + Optical Flow fallback)
**Gerekçe:**
- CSRT: Robust ROI tracking, handles scale changes
- Template Matching: Precise seed point localization
- Optical Flow: Fallback when template fails
- V2.2'de ~150-350ms/frame performans
- Confidence scoring ile auto-stop
**Sonuçlar:**
- opencv-contrib-python gerekli (CSRT için)
- 35x35 template size
- 5-frame rolling confidence window
- Auto-stop threshold: 0.6
**Referanslar:**
- Lukezic et al., CVPR 2017 (CSRT)
- Lucas-Kanade, 1981

---

## [DECISION-006] Geliştirme Stratejisi: Layer-by-Layer
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Projeyi nasıl aşamalı geliştireceğiz?
**Alternatifler:**
1. Vertical Slice (feature by feature)
2. Layer-by-Layer (infrastructure first)
3. Prototype-then-rewrite
**Karar:** Layer-by-Layer
**Gerekçe:**
- Daha sağlam temel altyapı
- Store'lar ve API'ler önce tasarlanır
- UI son katman olarak eklenir
- Akademik proje için daha iyi dokümantasyon imkanı
- Her katman ayrı ayrı test edilebilir
**Sonuçlar:**
- Faz 1: Backend API'leri (stub + core)
- Faz 2: Zustand store'ları
- Faz 3: UI bileşenleri
- Faz 4: Entegrasyon + Polish
**Referanslar:**
- Clean Architecture, Robert C. Martin

---

## [DECISION-007] Akademik Dokümantasyon Yapısı
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Makale yazımı için dokümantasyon nasıl organize edilmeli?
**Alternatifler:**
1. Kod içi comments only
2. Ayrı docs/ klasörü
3. Dedicated akademik/ workspace
4. Wiki-based
**Karar:** Hybrid: .context/ (technical) + akademik/ (publication)
**Gerekçe:**
- .context/: Development decisions, architecture
- akademik/: Literature review, manuscript drafts
- Ayrım: Kod geliştirme vs akademik yazım
- decision.log: Kronolojik karar geçmişi
**Sonuçlar:**
- Her önemli karar loglanacak
- Literature review organize edilecek
- Figures ve data ayrı tutulacak
- Manuscript incremental olarak yazılacak
**Referanslar:**
- JOSS (Journal of Open Source Software) guidelines

---

## [DECISION-008] Custom nnU-Net Model as Primary Segmentation
**Tarih:** 2024-11-24
**Durum:** Accepted
**Bağlam:** Projede özel eğitilmiş bir nnU-Net modeli kullanılacak. Bu modelin mimarisi ve entegrasyonu nasıl olmalı?
**Alternatifler:**
1. AngioPy (pre-trained, seed point required)
2. Custom nnU-Net (ROI-based, dual-channel)
3. Hybrid (both models)
**Karar:** Custom nnU-Net v2 as PRIMARY segmentation model
**Gerekçe:**
- **Akademik değer:** Kendi eğittiğimiz model, yayın için özgün katkı
- **ROI-based input:** Seed point gerektirmez, ROI yeterli
- **Dual-channel architecture:** Image + Gaussian spatial attention
- **Bifurcation handling:** Post-processing ile yan dal supression
- **nnU-Net framework:** Self-configuring, reproducible, well-documented
- **State-of-the-art:** 23+ challenge'da birinci olan framework
**Sonuçlar:**
- Seed points opsiyonel (sadece AngioPy fallback için)
- ROI, hem tracking hem segmentasyon için kullanılacak
- Model mimarisi akademik düzeyde dokümante edilecek
- Training data ve parametreleri yayınlanacak
- Inference pipeline: ROI crop → Dual-channel → nnU-Net → Post-process
**Teknik Detaylar:**
- Input: (2, H, W) - [grayscale_image, gaussian_spatial_map]
- Gaussian sigma: 35 pixels (ROI center-focused)
- Post-processing: CenterComponentKeeper (bifurcation suppression)
- Output: Binary mask + probability map
**Dokümantasyon:**
- `.context/domain/segmentation-model-architecture.md` - Model detayları
- `akademik/literature/segmentation-papers/` - İlgili literatür
**Referanslar:**
- Isensee, F., et al. "nnU-Net: a self-configuring method for deep learning-based biomedical image segmentation." Nature Methods 18, 203–211 (2021)
- Ronneberger, O., et al. "U-Net: Convolutional Networks for Biomedical Image Segmentation." MICCAI 2015
- Model training details: [TO BE DOCUMENTED]

---

*Bu log, proje boyunca güncellenecektir.*
